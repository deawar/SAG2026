<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Admin dashboard for Silent Auction Gallery management">
    <title>Admin Dashboard - Silent Auction Gallery</title>
    
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/responsive.css">
    <link rel="stylesheet" href="/css/accessibility.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico">
</head>
<body>
    <!-- Skip link -->
    <a href="#main-content" class="skip-to-main">Skip to main content</a>

    <!-- Navigation Header -->
    <header class="navbar navbar-admin" role="banner">
        <div class="navbar-container">
            <div class="navbar-brand">
                <a href="/admin-dashboard.html" class="logo" aria-label="Admin Dashboard">                    <img src="/images/logo/SAGLive.png" alt="Silent Auction Gallery Logo" class="logo-img">                    <span class="logo-text">SAG Admin</span>
                </a>
            </div>
            <nav class="navbar-nav" role="navigation" aria-label="Admin Navigation">
                <ul class="nav-list">
                    <li><a href="/admin-dashboard.html" class="nav-link active" aria-current="page">Dashboard</a></li>
                    <li><a href="#auctions" class="nav-link" data-tab="auctions">Auctions</a></li>
                    <li><a href="#users" class="nav-link" data-tab="users">Users</a></li>
                    <li><a href="#payments" class="nav-link" data-tab="payments">Payments</a></li>
                    <li><a href="#reports" class="nav-link" data-tab="reports">Reports</a></li>
                </ul>
            </nav>
            <div class="navbar-auth">
                <button class="btn btn-profile" id="admin-user-btn" aria-label="Admin account menu" aria-expanded="false">
                    <span id="admin-name"></span>
                    <span class="menu-icon" aria-hidden="true">▼</span>
                </button>
                <div class="user-dropdown" id="admin-dropdown" style="display:none;" role="menu">
                    <a href="/admin-dashboard.html" class="dropdown-item" role="menuitem">Admin Dashboard</a>
                    <a href="#settings" class="dropdown-item" role="menuitem">Settings</a>
                    <button class="dropdown-item" id="admin-logout-btn" role="menuitem">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="main-content">
        <div class="container-admin">
            <!-- Breadcrumb Navigation -->
            <nav class="breadcrumb" role="navigation" aria-label="Breadcrumb navigation">
                <ol>
                    <li><a href="/">Home</a></li>
                    <li><span aria-current="page">Admin Dashboard</span></li>
                </ol>
            </nav>

            <!-- Page Header -->
            <div class="admin-header" role="region" aria-label="Admin Page Header">
                <h1>Admin Dashboard</h1>
                <p>Manage auctions, users, and monitor system performance</p>
            </div>

            <!-- Stats Overview -->
            <section class="stats-overview" role="region" aria-label="System Statistics">
                <h2 class="sr-only">System Statistics</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Active Auctions</h3>
                        <p class="stat-value" id="stat-active-auctions" aria-live="polite">0</p>
                        <p class="stat-label">Live bidding</p>
                    </div>

                    <div class="stat-card">
                        <h3>Total Bids</h3>
                        <p class="stat-value" id="stat-total-bids" aria-live="polite">0</p>
                        <p class="stat-label">This month</p>
                    </div>

                    <div class="stat-card">
                        <h3>Total Revenue</h3>
                        <p class="stat-value" id="stat-total-revenue" aria-live="polite">$0</p>
                        <p class="stat-label">From auctions</p>
                    </div>

                    <div class="stat-card">
                        <h3>Active Users</h3>
                        <p class="stat-value" id="stat-active-users" aria-live="polite">0</p>
                        <p class="stat-label">Right now</p>
                    </div>
                </div>
            </section>

            <!-- Admin Tabs -->
            <div class="admin-tabs">
                <nav role="tablist" aria-label="Admin sections" class="tabs-list">
                    <button 
                        role="tab" 
                        aria-selected="true" 
                        aria-controls="overview" 
                        class="tab-button active" 
                        id="tab-overview"
                        tabindex="0"
                    >
                        Overview
                    </button>
                    <button 
                        role="tab" 
                        aria-selected="false" 
                        aria-controls="auctions-tab" 
                        class="tab-button" 
                        id="tab-auctions-mgmt"
                        tabindex="-1"
                    >
                        Auctions
                    </button>
                    <button 
                        role="tab" 
                        aria-selected="false" 
                        aria-controls="users-tab" 
                        class="tab-button" 
                        id="tab-users-mgmt"
                        tabindex="-1"
                    >
                        Users
                    </button>
                    <button 
                        role="tab" 
                        aria-selected="false" 
                        aria-controls="payments-tab" 
                        class="tab-button" 
                        id="tab-payments"
                        tabindex="-1"
                    >
                        Payments
                    </button>
                    <button 
                        role="tab" 
                        aria-selected="false" 
                        aria-controls="reports-tab" 
                        class="tab-button" 
                        id="tab-reports"
                        tabindex="-1"
                    >
                        Reports
                    </button>
                </nav>
            </div>

            <!-- Tab Content -->
            <div class="admin-content">
                <!-- Overview Tab -->
                <section role="tabpanel" id="overview" aria-labelledby="tab-overview" class="tab-content active">
                    <h2>System Overview</h2>

                    <!-- Recent Activity -->
                    <div class="section-box">
                        <h3>Recent Activity</h3>
                        <div id="recent-activity" class="activity-log" role="log" aria-live="polite" aria-label="System activity log">
                            <p class="loading-message">Loading activity...</p>
                        </div>
                    </div>

                    <!-- System Health -->
                    <div class="section-box">
                        <h3>System Health</h3>
                        <div id="system-health" class="health-indicators" role="region" aria-label="System health metrics">
                            <p class="loading-message">Loading health metrics...</p>
                        </div>
                    </div>
                </section>

                <!-- Auctions Management Tab -->
                <section role="tabpanel" id="auctions-tab" aria-labelledby="tab-auctions-mgmt" class="tab-content" style="display:none;">
                    <h2>Manage Auctions</h2>

                    <div class="admin-actions">
                        <button class="btn btn-primary" id="create-auction-btn" type="button" aria-label="Create a new auction">
                            <span aria-hidden="true">+</span> Create New Auction
                        </button>
                        <select id="auction-status-filter" class="form-control" aria-label="Filter auctions by status" style="max-width:200px;">
                            <option value="">All Statuses</option>
                            <option value="DRAFT">Draft</option>
                            <option value="PENDING_APPROVAL">Pending Approval</option>
                            <option value="APPROVED">Approved</option>
                            <option value="LIVE">Live</option>
                            <option value="ENDED">Ended</option>
                            <option value="CANCELLED">Cancelled</option>
                        </select>
                        <input
                            type="search"
                            id="auction-search"
                            class="form-control"
                            placeholder="Search auctions..."
                            aria-label="Search auctions by title or ID"
                            style="flex:1;"
                        >
                    </div>

                    <div class="table-wrapper" role="region" aria-label="Auctions table">
                        <table class="admin-table" role="grid">
                            <thead>
                                <tr>
                                    <th scope="col">Title</th>
                                    <th scope="col">School</th>
                                    <th scope="col">Payment Provider</th>
                                    <th scope="col">Status</th>
                                    <th scope="col">Bids</th>
                                    <th scope="col">Current Bid</th>
                                    <th scope="col">Ends</th>
                                    <th scope="col">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="auctions-table-body">
                                <tr><td colspan="8" class="loading-message">Loading auctions...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Users Management Tab -->
                <section role="tabpanel" id="users-tab" aria-labelledby="tab-users-mgmt" class="tab-content" style="display:none;">
                    <h2>Manage Users</h2>

                    <div class="admin-actions">
                        <button class="btn btn-primary" id="create-user-btn" type="button" aria-label="Add new user">
                            <span aria-hidden="true">+</span> Add User
                        </button>
                        <input 
                            type="search" 
                            id="user-search" 
                            class="form-control" 
                            placeholder="Search users..." 
                            aria-label="Search users by name or email"
                            style="flex:1;"
                        >
                        <select id="user-role-filter" class="form-control" aria-label="Filter users by role" style="width:200px;">
                            <option value="">All Roles</option>
                            <option value="SITE_ADMIN">Site Admin</option>
                            <option value="SCHOOL_ADMIN">School Admin</option>
                            <option value="TEACHER">Teacher</option>
                            <option value="STUDENT">Student</option>
                            <option value="BIDDER">Bidder</option>
                        </select>
                    </div>

                    <div class="table-wrapper" role="region" aria-label="Users table">
                        <table class="admin-table" role="grid">
                            <thead>
                                <tr>
                                    <th scope="col">Name</th>
                                    <th scope="col" class="col-hide-sm">Role</th>
                                    <th scope="col">Status</th>
                                    <th scope="col" class="col-hide-sm">MFA</th>
                                    <th scope="col" class="col-hide-md">Phone</th>
                                    <th scope="col" class="col-hide-md">School</th>
                                    <th scope="col" class="col-hide-md">Bids</th>
                                    <th scope="col">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="users-table-body">
                                <tr><td colspan="8" class="loading-message">Loading users...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Payments Tab -->
                <section role="tabpanel" id="payments-tab" aria-labelledby="tab-payments" class="tab-content" style="display:none;">
                    <h2>Payment Management</h2>

                    <!-- Payment Gateways -->
                    <div class="section-box" id="gateway-setup-section">
                        <h3>Payment Gateways</h3>
                        <p class="section-help">Each school needs a payment gateway before auctions can be created. Use the test gateway for development and testing.</p>
                        <div style="display:flex; gap:1rem; align-items:flex-end; flex-wrap:wrap; margin-top:1rem;">
                            <div class="form-group" style="flex:1; min-width:200px; margin-bottom:0;">
                                <label for="gateway-school-search">School</label>
                                <input type="text" id="gateway-school-search" class="form-control"
                                       placeholder="Type to search schools..." autocomplete="off">
                                <select id="gateway-school-select" class="form-control" style="margin-top:0.5rem;">
                                    <option value="">— Select a school —</option>
                                </select>
                            </div>
                            <div style="display:flex; gap:0.5rem; flex-shrink:0;">
                                <button class="btn btn-secondary" id="check-gateway-btn" type="button">Check Status</button>
                                <button class="btn btn-primary" id="setup-test-gateway-btn" type="button">Setup Test Gateway</button>
                            </div>
                        </div>
                        <div id="gateway-status" role="status" aria-live="polite" style="margin-top:0.75rem;"></div>
                    </div>

                    <!-- Transactions -->
                    <h3 style="margin-top:2rem;">Transactions</h3>
                    <div class="admin-actions">
                        <select id="payment-status-filter" class="form-control" aria-label="Filter payments by status">
                            <option value="">All Statuses</option>
                            <option value="pending">Pending</option>
                            <option value="completed">Completed</option>
                            <option value="failed">Failed</option>
                            <option value="refunded">Refunded</option>
                        </select>
                        <input 
                            type="search" 
                            id="payment-search" 
                            class="form-control" 
                            placeholder="Search payments..." 
                            aria-label="Search payments by transaction ID or user"
                            style="flex:1;"
                        >
                    </div>

                    <div class="table-wrapper" role="region" aria-label="Payments table">
                        <table class="admin-table" role="grid">
                            <thead>
                                <tr>
                                    <th scope="col">User</th>
                                    <th scope="col">Amount</th>
                                    <th scope="col">Method</th>
                                    <th scope="col">Status</th>
                                    <th scope="col">Date</th>
                                    <th scope="col">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="payments-table-body">
                                <tr><td colspan="6" class="loading-message">Loading payments...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Reports Tab -->
                <section role="tabpanel" id="reports-tab" aria-labelledby="tab-reports" class="tab-content" style="display:none;">
                    <h2>Reports</h2>

                    <div class="reports-grid">
                        <div class="report-card">
                            <h3>Revenue Report</h3>
                            <p>Track auction revenue and payments</p>
                            <button class="btn btn-secondary" id="revenue-report-btn" type="button">View Report</button>
                        </div>

                        <div class="report-card">
                            <h3>User Activity Report</h3>
                            <p>Monitor bidder and school activity</p>
                            <button class="btn btn-secondary" id="activity-report-btn" type="button">View Report</button>
                        </div>

                        <div class="report-card">
                            <h3>Auction Performance</h3>
                            <p>Analyze auction success rates</p>
                            <button class="btn btn-secondary" id="performance-report-btn" type="button">View Report</button>
                        </div>

                        <div class="report-card">
                            <h3>Compliance & Audit Trail</h3>
                            <p>Review system logs and compliance data</p>
                            <button class="btn btn-secondary" id="compliance-report-btn" type="button">View Report</button>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- Modal: Create/Edit Auction -->
    <div id="auction-form-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="auction-modal-title" style="display:none;">
        <div class="modal-content modal-large">
            <button class="modal-close" aria-label="Close auction form">&times;</button>
            
            <h2 id="auction-modal-title">Create New Auction</h2>
            <form id="auction-form" class="admin-form" aria-label="Auction form">
                <!-- Form content will be populated by JavaScript -->
            </form>
        </div>
    </div>

    <!-- Modal: User Details -->
    <div id="user-detail-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="user-modal-title" style="display:none;">
        <div class="modal-content modal-medium">
            <button class="modal-close" aria-label="Close user details">&times;</button>
            
            <h2 id="user-modal-title">User Details</h2>
            <div id="user-detail-content">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Alert Container -->
    <div id="alert-container" class="alert-container" role="region" aria-live="polite" aria-atomic="true"></div>

    <!-- Footer -->
    <footer class="footer" role="contentinfo">
        <div class="container">
            <p>&copy; 2026 Silent Auction Gallery Admin. All rights reserved.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/js/accessibility.js"></script>
    <script src="/js/api-client.js"></script>
    <script src="/js/websocket-client.js"></script>
    <script src="/js/auth-manager.js"></script>
    <script src="/js/ui-components.js"></script>
    <script src="/js/admin-dashboard.js"></script>
</body>
</html>
